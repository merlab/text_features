library(caret)
library(PharmacoGx)
source("./R/summarizeData.R")
source("./summarizeData.R")
GDSC2 <- readRDS("../data/GDSC2.rds")
df = summarizeData(pSet=GDSC2, mDataType = "Kallisto_0.46.1.rnaseq", drug = "Erlotinib", sensitivity.measure="aac_recomputed")
library(PharmacoGx)
df = summarizeData(pSet=GDSC2, mDataType = "Kallisto_0.46.1.rnaseq", drug = "Erlotinib", sensitivity.measure="aac_recomputed")
library(SummarizedExperiment)
df = summarizeData(pSet=GDSC2, mDataType = "Kallisto_0.46.1.rnaseq", drug = "Erlotinib", sensitivity.measure="aac_recomputed")
df = df[1:2000,]
df = df[, !is.na(colData(df)$aac_recomputed)]
NAsamples <- apply(assay(df), 2, function(i) any(is.na(i)))
df <- df[, !NAsamples]
gene_vars <- apply(assay(df), 1, var)
df <- df[gene_vars>0, ]
x <- t(assay(df))
y <- colData(df)$aac_recomputed
train_result_sample <- train(x=x,
y=y,
method="glmnet",
preProcess=c("center", "scale"),
maximize = TRUE,
na.rm = TRUE,
tuneGrid=expand.grid(alpha=seq(0, 1, 0.2),
lambda=seq(0, 10, 1)),
trControl=trainControl(method="repeatedcv",
number=10,
repeats=5,
search="grid",
predictionBounds = c(0, 1),
allowParallel = TRUE,
verboseIter=TRUE))
pred_sample <- data.frame(predict=predict(train_result_sample, x), original=y)
View(pred_sample)
View(train_result_sample)
train_results_sample$results
train_results_sample@results
train_results_sample
train_result_sample
train_result_sample$results
bwplot(train_result_sample)
bwplot(train_result_sample$results)
bwplot(train_result_sample$results$RMSE)
train_result_sample$results$RMSE
train_result_sample$results$RMSE[0:12]
bwplot(train_result_sample$results$RMSE[0:12])
bwplot(train_result_sample$results$RMSE[0:11])
bwplot(train_result_sample$results$RMSE, horizontal = FALSE)
bwplot(t(train_result_sample$results$RMSE[0:11]))
bwplot(train_result_sample$results$RMSE[0:11])
bwplot(train_result_sample$results$RMSE,  xlab="RMSE", ylab = "Erlotinib")
bwplot(train_result_sample$results$RMSE[0:11],  xlab="RMSE", ylab = "Erlotinib")
bwplot(train_result_sample$results$RMSE[0:11],  xlab="RMSE", ylab = "Erlotinib", main = "Model Accuracy by Drug")
train_result_sample <- train(x=x,
y=y,
method="glmnet",
preProcess=c("center", "scale"),
maximize = TRUE,
na.rm = TRUE,
tuneGrid=expand.grid(alpha=seq(0, 1, 0.2),
lambda=seq(0, 10, 1)),
trControl=trainControl(method="repeatedcv",
number=10,
search="grid",
predictionBounds = c(0, 1),
allowParallel = TRUE,
verboseIter=TRUE))
bwplot(train_result_sample$results$RMSE)
train_result_sample
bwplot(train_result_sample$results$RMSE,  xlab="RMSE", ylab = "Erlotinib", main = "Model Accuracy by Drug")
load("~/text_features/R/.RData")
train_result_sample$resample
train_result_sample <- train(x=x,
y=y,
method="glmnet",
preProcess=c("center", "scale"),
maximize = TRUE,
tuneGrid=expand.grid(alpha=seq(0, 1, 0.2),
lambda=seq(0, 10, 1)),
trControl=trainControl(method="repeatedcv",
number=10,
search="grid",
savePredictions ="all",
allowParallel = TRUE,
verboseIter=TRUE))
library(caret)
library(psych)
library(PharmacoGx)
library(SummarizedExperiment)
train_result_sample <- train(x=x,
y=y,
method="glmnet",
preProcess=c("center", "scale"),
maximize = TRUE,
tuneGrid=expand.grid(alpha=seq(0, 1, 0.2),
lambda=seq(0, 10, 1)),
trControl=trainControl(method="repeatedcv",
number=10,
search="grid",
savePredictions ="all",
allowParallel = TRUE,
verboseIter=TRUE))
saveRDS(train_result_sample, "model.rds")
pred_sample <- data.frame(predict=predict(train_result_sample, x), original=y)
View(pred_sample)
bwplot(train_result_sample$resample$RMSE,  xlab="RMSE", ylab = "Erlotinib", main = "Model Accuracy by Drug")
View(train_result_sample)
View(train_result_sample)
View(train_result_sample)
data$pred <- train_result_sample$pred[ , "pred"]
data <- train_result_sample$pred[ , "pred"]
data
train_result_sample$pred
train_result_sample$trainingData <- NULL
